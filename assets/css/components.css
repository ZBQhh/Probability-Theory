/* ==========================================================================
   FILE: assets/css/components.css
   æè¿°: UI ç»„ä»¶ (ä¼˜é›…çš„æ‚¬æµ®é“¾æ¥ç‰ˆ)
   ========================================================================== */

/* ================== 1. ç¯å¢ƒå—ä¸ Permalink ================== */
.block {
  position: relative;
  margin: 1.8em 0;
  padding: 1.2em 1.5em;
  border-radius: var(--block-radius);
  box-shadow: 0 4px 15px var(--shadow);
  transition: box-shadow 0.3s ease;
  font-family: "Arial", "Noto Serif SC", sans-serif;
  
  /* ç¡®ä¿ permalink ç»å¯¹å®šä½ä»¥æ­¤ä¸ºåŸºå‡† */
  overflow: hidden; 
}

/* æ ‡é¢˜åŒºåŸŸ */
.env-heading {
  margin-bottom: 0.8em;
  line-height: 1.5;
  
  /* ğŸ’¥ æ ¸å¿ƒä¿®æ”¹ï¼šç§»é™¤å³ä¾§å¼ºåˆ¶ç•™ç™½ */
  /* è®©æ ‡é¢˜æ–‡å­—å¯ä»¥æµå‘æœ€å³è¾¹ï¼Œä¸å†æµªè´¹æ‰‹æœºå±å¹•ç©ºé—´ */
  padding-right: 0; 
  
  position: relative;
  width: 100%;
}

/* ğŸ’¥ Permalink (å¤åˆ¶é“¾æ¥ Â¶) æ™ºèƒ½æ‚¬æµ®ç‰ˆ */
.permalink {
  position: absolute;
  /* å®šä½åˆ°å³ä¸Šè§’ï¼Œç¨å¾®ç•™ç‚¹è¾¹è· */
  top: 0.5em;
  right: 0.5em;
  
  width: 2em;
  height: 2em;
  line-height: 2em;
  text-align: center;
  font-size: 1.2em;
  
  color: var(--accent);
  text-decoration: none;
  border-radius: 50%; /* åœ†å½¢æŒ‰é’®æ›´ç°ä»£ */
  
  /* æ ¸å¿ƒæŠ€å·§ï¼šå¹³æ—¶éšèº«ä¸”â€œç©¿é€â€ */
  opacity: 0;
  pointer-events: none; /* å…³é”®ï¼éšè—æ—¶é¼ æ ‡å¯ä»¥ç©¿é€å®ƒå»å¤åˆ¶ä¸‹é¢çš„æ–‡å­— */
  transform: scale(0.8);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  
  z-index: 20; /* ä¿è¯åœ¨æœ€ä¸Šå±‚ */

  /* ä¼˜é›…çš„é®ç›–èƒŒæ™¯ï¼šå½“å®ƒå‡ºç°æ—¶ï¼Œä¸ºäº†é˜²æ­¢å’Œåº•éƒ¨æ–‡å­—é‡å çœ‹ä¸æ¸…ï¼Œ
     ç»™å®ƒåŠ ä¸€ä¸ªå’Œç¯å¢ƒå—ä¸€æ ·çš„èƒŒæ™¯è‰²ï¼Œå½¢æˆâ€œé®ç½©â€æ•ˆæœ */
  background-color: var(--block-bg); 
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  backdrop-filter: blur(2px); /* ç£¨ç ‚ç»ç’ƒæ„Ÿ (å¯é€‰) */
}

/* äº¤äº’é€»è¾‘ */

/* 1. é¼ æ ‡æ‚¬åœ (PC) */
.block:hover .permalink {
  opacity: 1;
  transform: scale(1);
  pointer-events: auto; /* å‡ºç°åï¼Œæ¢å¤å¯ç‚¹å‡»çŠ¶æ€ */
}

/* 2. è§¦æ‘¸æ¿€æ´» (Mobile) */
/* åœ¨æ‰‹æœºä¸Šï¼Œç‚¹å‡»ç¯å¢ƒå—æ—¶ï¼Œé“¾æ¥æµ®ç° */
.block:active .permalink,
.block:focus-within .permalink {
  opacity: 1;
  transform: scale(1);
  pointer-events: auto;
}

.permalink:hover {
  background-color: var(--accent);
  color: #fff;
  box-shadow: 0 4px 12px rgba(var(--accent-rgb, 0,0,0), 0.3);
}

/* å…¬å¼ç¯å¢ƒå†…çš„ Permalink */
.math-display-block {
  position: relative;
}
/* å…¬å¼å—æ‚¬åœæ—¶æ˜¾ç¤º */
.math-display-block:hover .permalink {
  opacity: 1;
  pointer-events: auto;
}
.math-display-block .permalink {
  top: 0;
  right: 0;
  background-color: transparent; /* å…¬å¼å—é€šå¸¸ç©ºç™½è¾ƒå¤šï¼Œä¸éœ€è¦èƒŒæ™¯é®ç½© */
  box-shadow: none;
}


/* ================== 2. ç›®å½• (TOC) æ ·å¼ (ä¿æŒä¹‹å‰çš„é€»è¾‘) ================== */
.toc { list-style: none; padding: 0; margin: 0; }

.toc-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin: 2px 0;
  border-radius: 6px;
  transition: background 0.2s;
}
.toc-row:hover { background: var(--toc-hover); }

.toc-link {
  flex: 1;
  padding: 0.6em 0.5em;
  color: var(--toc-text);
  text-decoration: none;
  font-size: 0.95em;
  font-weight: 500;
  display: block;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.toc-link.active { color: var(--accent); font-weight: 700; }

.toc-toggle-btn {
  width: 34px; /* ç¨å¾®åŠ å¤§è§¦æ§åŒºåŸŸ */
  height: 34px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: var(--muted);
  font-size: 0.8em;
  transition: transform 0.3s ease;
}
.toc-toggle-btn:hover { color: var(--accent); }

.toc-item-h2 .toc-sub {
  display: block;
  padding-left: 1.2em;
  max-height: 1000px; 
  overflow: hidden;
  transition: max-height 0.4s ease-out, opacity 0.4s ease;
  opacity: 1;
}
.toc-item-h2.collapsed .toc-sub {
  max-height: 0;
  opacity: 0;
}
.toc-item-h2.collapsed .toc-toggle-btn {
  transform: rotate(-90deg);
}

.toc-item-h3 a {
  display: block;
  padding: 0.4em 0.5em 0.4em 1em;
  color: var(--toc-text);
  opacity: 0.85;
  text-decoration: none;
  font-size: 0.9em;
  border-left: 2px solid transparent;
}
.toc-item-h3 a:hover { color: var(--accent); opacity: 1; }
.toc-item-h3 a.active {
  color: var(--accent);
  border-left-color: var(--accent);
  background: var(--toc-active-bg);
  opacity: 1;
}

/* ================== 3. å…¶ä»–é€šç”¨ ================== */
.env-body { color: var(--text); }
.search-box { background: var(--bg); border: 1px solid var(--muted); }
#searchInput { background: transparent; color: var(--text); }
.res-tag { color: #fff !important; }