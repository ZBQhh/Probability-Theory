/* ==========================================================================
   FILE: assets/css/base.css
   æè¿°: åŸºç¡€æ’ç‰ˆ + MathJax å¸ƒå±€ + è§¦æ§ä¼˜åŒ–
   (å·²å®Œå…¨å¯¹æ¥ variables.cssï¼Œå®ç°å•ä¸€æ•°æ®æºæ§åˆ¶)
   ========================================================================== */

/* ================== 1. åŸºç¡€æ’ç‰ˆ (Typography & Reset) ================== */
html { 
  scroll-behavior: smooth; 
  overflow-x: hidden; 
}

body {
  /* 1. å­—ä½“å®Œå…¨ç”±å˜é‡æ§åˆ¶ */
  font-family: var(--font-body, serif);
  max-width: 100%;
  margin: 0; 
  padding: 0;
  line-height: 1.85;
  /* 2. é¢œè‰²å®Œå…¨ç”±å˜é‡æ§åˆ¶ */
  background: var(--bg);
  color: var(--text);
  overflow-x: hidden;
  -webkit-text-size-adjust: 100%;
}

/* --- æ ‡é¢˜é€šç”¨æ ·å¼ --- */
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-heading, sans-serif);
  font-weight: 600; 
  line-height: 1.4; 
  color: var(--text);
  margin-top: 1.5em; 
  margin-bottom: 0.75em; 
  word-break: break-word;
}

h1 { 
  font-size: 2.2em; 
  margin-top: 0.5em; 
  border-bottom: 3px solid var(--accent); 
  padding-bottom: 0.3em; 
}

h2 { 
  font-size: 1.8em; 
  border-bottom: 2px solid var(--muted); 
  padding-bottom: 0.25em; 
  position: relative; 
}

h3 { 
  font-size: 1.15em; 
  color: var(--text); 
  position: relative; 
  margin-top: 1.2em; 
}

/* ğŸ’¥ [æ ¸å¿ƒå¯¹æ¥] æ ‡é¢˜åºå·é—´è· */
/* ç»Ÿä¸€æ§åˆ¶ JS ç”Ÿæˆçš„ <span class="heading-number"> */
.heading-number,
.sec-num,
.subsec-num {
  /* å¼•ç”¨å˜é‡ï¼šå» variables.css ä¿®æ”¹ --heading-num-spacing å³å¯å…¨å±€ç”Ÿæ•ˆ */
  margin-right: var(--heading-num-spacing, 0.8em) !important;
  display: inline-block; /* é˜²æ­¢æ¢è¡Œ */
}

/* å¤‡é€‰ï¼šå¦‚æœæœ‰äº›åºå·æ˜¯ CSS è®¡æ•°å™¨ç”Ÿæˆçš„ */
h3::before, h4::before {
  margin-right: var(--heading-num-spacing, 0.8em);
}

/* --- æ­£æ–‡å…ƒç´  --- */
p { margin: 1em 0; text-align: justify;
text-indent: 2em;
/* åº”ç”¨å˜é‡ */
  line-height: var(--line-height, 1.8);
  margin-top: var(--para-spacing, 1em); 
  margin-bottom: var(--para-spacing, 1em); 
}

strong, b { font-weight: 600; color: var(--text); }
em, i { font-style: italic; }

/* --- é“¾æ¥ --- */
a { 
  color: var(--accent); 
  text-decoration: none; 
  transition: color 0.2s; 
}
a:hover { 
  color: var(--text); /* hover æ—¶ç¨å¾®å˜æ·±ä¸€ç‚¹ï¼Œæˆ–è€…ä½ å¯ä»¥å®šä¹‰ä¸“é—¨çš„å˜é‡ */
  text-decoration: underline; 
}

/* --- åˆ—è¡¨ --- */
ul, ol { margin: 0em 0; padding-left: 1em; }
li { margin: 0.5em 0; }

/* --- å¼•ç”¨å— --- */
blockquote { 
  margin: 1.5em 0; 
  padding: 1em 1.5em; 
  border-left: 4px solid var(--accent); 
  background: var(--bg); /* ä¿æŒèƒŒæ™¯ä¸€è‡´ï¼Œæˆ–è€…å®šä¹‰ --bg-secondary */
  color: var(--muted); 
  font-style: italic; 
}

/* --- ä»£ç å— --- */
code { 
  font-family: var(--font-mono, monospace); 
  background: rgba(0,0,0,0.05); 
  padding: 0.2em 0.4em; 
  border-radius: 4px; 
  font-size: 0.9em; 
  color: var(--accent); 
  word-break: break-all; 
}

pre { 
  background: rgba(0,0,0,0.05); 
  padding: 1em; 
  border-radius: 8px; 
  overflow-x: auto; 
  margin: 1.5em 0; 
  max-width: 100%; 
}
pre code { background: none; padding: 0; color: inherit; }

hr { border: none; border-top: 2px solid var(--muted); margin: 2em 0; opacity: 0.3; }

/* --- é”šç‚¹è·³è½¬åç§» (é˜²æ­¢è¢«é¡¶éƒ¨å¯¼èˆªé®æŒ¡) --- */
:target { scroll-margin-top: 90px; }

/* --- å¼•ç”¨é«˜äº®åŠ¨ç”» --- */
@keyframes flash-highlight { 
  0% { background-color: rgba(255, 255, 0, 0.3); } 
  100% { background-color: transparent; } 
}
.highlight-flash { animation: flash-highlight 2s ease-out; border-radius: 4px; }


/* ==========================================================================
   2. æ•°å­¦å…¬å¼å¸ƒå±€ç³»ç»Ÿ (è§¦æ§ä¼˜åŒ–ç‰ˆ)
   ========================================================================== */

/* 1. åŸºç¡€å®¹å™¨ */
.math-display-block {
  width: 100%;
  margin: 1.5em 0;
  clear: both;
}

/* 2. æ»šåŠ¨å®¹å™¨ */
.math-scroll-view {
  width: 100%;
  flex: 1; width: 0; min-width: 0;
  overflow-x: auto;
  overflow-y: hidden;
  text-align: center;
  padding-bottom: 6px;
  
  /* è§¦æ§ä¼˜åŒ– */
  -webkit-overflow-scrolling: touch; 
  touch-action: pan-x;               
  -webkit-tap-highlight-color: transparent;
  cursor: grab;                      
  user-select: text;                 
}

/* æ»šåŠ¨æ¡æ ·å¼ */
.math-scroll-view::-webkit-scrollbar, mjx-container::-webkit-scrollbar { height: 6px; background: transparent; }
.math-scroll-view::-webkit-scrollbar-thumb, mjx-container::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.1); border-radius: 4px; }
.math-scroll-view:hover::-webkit-scrollbar-thumb, mjx-container:hover::-webkit-scrollbar-thumb { background: var(--accent); }

/* 3. å³ä¾§ä¿¡æ¯æ  (åºå·) */
.math-info {
  flex-shrink: 0;
  margin-left: 20px;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  font-size: 0.95em;
  color: var(--muted);
  white-space: nowrap;
}
.math-name { margin-left: 0.8em; font-style: italic; opacity: 0.8; color: var(--muted); }

/* 4. MathJax å®¹å™¨ (ä¼ é€’è§¦æ§å±æ€§) */
mjx-container[display="true"] {
  display: block !important; overflow-x: auto !important; overflow-y: hidden;
  max-width: 100% !important; width: 100% !important; margin: 0.5em 0 !important; padding-bottom: 4px;
  touch-action: pan-x;
  -webkit-tap-highlight-color: transparent;
}

.math-scroll-view mjx-container[display="true"] {
  display: inline-block !important; overflow: visible !important;
  max-width: none !important; width: auto !important; margin: 0 !important; vertical-align: middle;
}
mjx-math { outline: none; }


/* ==========================================================================
   3. MathJax è¡Œå†…å…¬å¼ä¼˜åŒ– (å·²ä¿®æ­£å˜é‡å)
   ========================================================================== */
/* é€‰ä¸­è¡Œå†…å…¬å¼ (æ’é™¤ display="true" çš„å—çº§å…¬å¼) */
mjx-container:not([display="true"]) {
  /* ğŸ’¥ æ ¸å¿ƒå¯¹æ¥ï¼šä¿®æ­£ä¸º --inline-math-spacing ä»¥åŒ¹é… variables.css */
  margin-left: var(--inline-math-spacing, 0.15em) !important;
  margin-right: var(--inline-math-spacing, 0.15em) !important;
  
  /* é˜²æ’‘å¤§è¡Œé«˜ */
  line-height: normal; 
}


/* ================== å“åº”å¼å¸ƒå±€ ================== */

@media (min-width: 769px) {
  .math-display-block {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
  }
}

@media (max-width: 768px) {
  .math-display-block { display: block; }
  .math-scroll-view { display: block; width: 100%; }
  
  .math-info {
    display: block;
    width: 100%;
    margin-left: 0;
    text-align: right;
    padding-top: 4px;
    padding-right: 2px;
  }
}