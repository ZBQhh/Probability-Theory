/* ==========================================================================
   FILE: assets/css/base.css
   æè¿°: åŸºç¡€æ’ç‰ˆ + æè‡´ä¸æ»‘çš„ç§»åŠ¨ç«¯æ»‘åŠ¨ä½“éªŒ
   ========================================================================== */

/* ================== 1. åŸå§‹è§†è§‰æ ·å¼ (ä¿æŒä¸å˜) ================== */
html { scroll-behavior: smooth; overflow-x: hidden; }

body {
  font-family: "Arial", "Noto Serif SC", serif;
  max-width: 100%;
  margin: 0; padding: 0;
  line-height: 1.85;
  background: var(--bg);
  color: var(--text);
  overflow-x: hidden;
  -webkit-text-size-adjust: 100%;
}

h1, h2, h3, h4, h5, h6 {
  font-family: "Source Han Sans SC", "æ€æºé»‘ä½“", "Microsoft YaHei", sans-serif;
  font-weight: 600; line-height: 1.4; color: var(--text);
  margin-top: 1.5em; margin-bottom: 0.75em; word-break: break-word;
}
h1 { font-size: 2.2em; margin-top: 0.5em; border-bottom: 3px solid var(--accent); padding-bottom: 0.3em; }
h2 { font-size: 1.8em; border-bottom: 2px solid var(--muted); padding-bottom: 0.25em; position: relative; padding-left: 1.8em; }
h3 { font-size: 1.15em; color: var(--text); position: relative; padding-left: 1.8em; margin-top: 1.2em; }

p { margin: 1em 0; text-align: justify; }
strong, b { font-weight: 600; color: var(--text); }
em, i { font-style: italic; }
a { color: var(--accent); text-decoration: none; transition: color 0.2s; }
a:hover { color: var(--c-theorem); text-decoration: underline; }

ul, ol { margin: 0em 0; padding-left: 1em; }
li { margin: 0.5em 0; }
blockquote { margin: 1.5em 0; padding: 1em 1.5em; border-left: 4px solid var(--accent); background: var(--bg); color: var(--muted); font-style: italic; }

code { font-family: "Consolas", "Monaco", monospace; background: rgba(0,0,0,0.05); padding: 0.2em 0.4em; border-radius: 4px; font-size: 0.9em; color: var(--accent); word-break: break-all; }
pre { background: rgba(0,0,0,0.05); padding: 1em; border-radius: 8px; overflow-x: auto; margin: 1.5em 0; max-width: 100%; }
pre code { background: none; padding: 0; color: inherit; }

hr { border: none; border-top: 2px solid var(--muted); margin: 2em 0; opacity: 0.3; }
:target { scroll-margin-top: 90px; }

@keyframes flash-highlight { 0% { background-color: rgba(255, 255, 0, 0.3); } 100% { background-color: transparent; } }
.highlight-flash { animation: flash-highlight 2s ease-out; border-radius: 4px; }
a.ref-link { color: var(--accent); border-bottom: 1px dashed var(--accent); padding: 0 2px; border-radius: 3px; }
a.ref-link:hover { background-color: rgba(74, 144, 226, 0.1); text-decoration: none; }


/* ==========================================================================
   2. æ•°å­¦å…¬å¼å¸ƒå±€ç³»ç»Ÿ (è§¦æ§ä¼˜åŒ–ç‰ˆ)
   ========================================================================== */

/* 1. åŸºç¡€å®¹å™¨ */
.math-display-block {
  width: 100%;
  margin: 1.5em 0;
  clear: both;
}

/* 2. æ»šåŠ¨ç¬¼å­ (é‡ç‚¹ä¼˜åŒ–åŒºåŸŸ) */
.math-scroll-view {
  width: 100%;
  
  /* Flex é€‚é… */
  flex: 1; width: 0; min-width: 0;
  
  /* æ»šåŠ¨æœºåˆ¶ */
  overflow-x: auto;
  overflow-y: hidden;
  text-align: center;
  padding-bottom: 6px;
  
  /* ğŸ’¥ [æ–°å¢] ç§»åŠ¨ç«¯è§¦æ§æ ¸å¿ƒä¼˜åŒ– */
  -webkit-overflow-scrolling: touch; /* iOS æƒ¯æ€§æ»šåŠ¨ */
  touch-action: pan-x;               /* å‘Šè¯‰æµè§ˆå™¨ï¼šè¿™é‡Œä¸“é—¨å¤„ç†æ°´å¹³æ»‘åŠ¨ï¼Œä¸è¦ç­‰å¾…ç‚¹å‡» */
  -webkit-tap-highlight-color: transparent; /* ç¦æ­¢ç‚¹å‡»æ—¶å‡ºç°è“è‰²é«˜äº®å— */
  cursor: grab;                      /* é¼ æ ‡å˜æˆæŠ“æ‰‹ï¼Œæç¤ºå¯æ‹–åŠ¨ */
  user-select: text;                 /* å…è®¸å¤åˆ¶ï¼Œä½†ä¸å…è®¸å¤§å—è¯¯é€‰ */
}

/* æ»šåŠ¨æ¡æ ·å¼ */
.math-scroll-view::-webkit-scrollbar, mjx-container::-webkit-scrollbar { height: 6px; background: transparent; }
.math-scroll-view::-webkit-scrollbar-thumb, mjx-container::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.1); border-radius: 4px; }
.math-scroll-view:hover::-webkit-scrollbar-thumb, mjx-container:hover::-webkit-scrollbar-thumb { background: var(--accent); }

/* 3. å³ä¾§ä¿¡æ¯æ  (åºå·) */
.math-info {
  flex-shrink: 0;
  margin-left: 20px;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  font-size: 0.95em;
  color: var(--muted);
  white-space: nowrap;
}
.math-name { margin-left: 0.8em; font-style: italic; opacity: 0.8; color: var(--muted); }

/* 4. MathJax å®¹å™¨ (ä¼ é€’è§¦æ§å±æ€§) */
mjx-container[display="true"] {
  display: block !important; overflow-x: auto !important; overflow-y: hidden;
  max-width: 100% !important; width: 100% !important; margin: 0.5em 0 !important; padding-bottom: 4px;
  
  /* ğŸ’¥ [æ–°å¢] ä¼ é€’è§¦æ§ä¼˜åŒ– */
  touch-action: pan-x;
  -webkit-tap-highlight-color: transparent;
}

.math-scroll-view mjx-container[display="true"] {
  display: inline-block !important; overflow: visible !important;
  max-width: none !important; width: auto !important; margin: 0 !important; vertical-align: middle;
  
  /* ğŸ’¥ [æ–°å¢] ç¦æ­¢ MathJax å†…éƒ¨æ‹¦æˆªç‚¹å‡»äº‹ä»¶ï¼Œç¡®ä¿æ»‘åŠ¨ä¼˜å…ˆ */
  /* pointer-events: none; ä¸è¦åŠ è¿™ä¸ªï¼Œå¦åˆ™ä¸èƒ½é•¿æŒ‰å¤åˆ¶å…¬å¼ */
}
mjx-math { outline: none; }


/* ================== å“åº”å¼å¸ƒå±€ ================== */

@media (min-width: 769px) {
  .math-display-block {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
  }
}

@media (max-width: 768px) {
  .math-display-block { display: block; }
  .math-scroll-view { display: block; width: 100%; }
  
  /* æ‰‹æœºç«¯ä¿¡æ¯æ  */
  .math-info {
    display: block;
    width: 100%;
    margin-left: 0;
    text-align: right;
    padding-top: 4px;
    padding-right: 2px;
  }
}