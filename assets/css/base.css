/* ==========================================================================
   FILE: assets/css/base.css
   æè¿°: åŸºç¡€æ’ç‰ˆä¸ç§»åŠ¨ç«¯å…¬å¼ç»ˆæé€‚é… (Zero-Width Flex Hack)
   ========================================================================== */

/* ================== å…¨å±€é‡ç½® ================== */
html {
  overflow-x: hidden; /* é˜²æ­¢é¡µé¢çº§æ™ƒåŠ¨ */
}

body {
  font-family: "Arial", "Noto Serif SC", serif;
  line-height: 1.85;
  background: var(--bg);
  color: var(--text);
  margin: 0;
  padding: 0;
  max-width: 100vw;   /* é”æ­» Body å®½åº¦ */
  overflow-x: hidden; /* åŒé‡é”æ­» */
}

/* ================== æ ‡é¢˜ä¸æ–‡æœ¬ ================== */
h1, h2, h3, h4, h5, h6 {
  font-family: "Source Han Sans SC", "æ€æºé»‘ä½“", sans-serif;
  font-weight: 600;
  color: var(--text);
  word-break: break-word; /* å…è®¸å•è¯å†…æ–­è¡Œ */
}

h1 { font-size: 2.2em; margin: 0.6em 0 1em 0; border-bottom: 3px solid var(--accent); padding-bottom: 0.3em; }
h2 { font-size: 1.8em; margin: 1.8em 0 0.9em 0; border-bottom: 2px solid var(--muted); padding-bottom: 0.25em; padding-left: 0.5em; border-left: 5px solid var(--muted); }
h3 { font-size: 1.25em; margin: 1.5em 0 0.75em 0; padding-left: 0.8em; border-left: 4px solid var(--accent); }

p { margin: 1em 0; text-align: justify; }
ul, ol { margin: 0.8em 0; padding-left: 1.5em; }
code { font-family: monospace; background: rgba(0,0,0,0.06); padding: 0.1em 0.3em; border-radius: 4px; color: var(--accent); word-break: break-all; }
pre { background: rgba(0,0,0,0.05); padding: 1em; border-radius: 8px; overflow-x: auto; margin: 1.5em 0; max-width: 100%; }
blockquote { margin: 1.5em 0; padding: 1em; border-left: 4px solid var(--accent); background: rgba(0,0,0,0.03); color: var(--muted); }
a { color: var(--accent); text-decoration: none; }
:target { scroll-margin-top: 80px; }

/* ================== [æ ¸å¿ƒä¿®å¤] å…¬å¼å®¹å™¨ (Zero-Width Hack) ================== */
/* 
   åŸç†ï¼š
   1. çˆ¶å®¹å™¨ .formula-wrapper è®¾ä¸º Flexã€‚
   2. æ»šåŠ¨åŒºåŸŸ .formula è®¾ä¸º flex: 1ï¼Œä½†å…³é”®æ˜¯ width: 0ã€‚
      è¿™ä¼šå‘Šè¯‰æµè§ˆå™¨ï¼šâ€œä¸ç®¡å†…å®¹å¤šå®½ï¼Œè¿™ä¸ªå®¹å™¨çš„åŸºç¡€å®½åº¦æ˜¯0â€ã€‚
   3. min-width: 0 å½»åº•ç§»é™¤â€œå†…å®¹æ’‘å¼€â€çš„ä¿æŠ¤æœºåˆ¶ã€‚
   4. è¿™æ · overflow-x: auto æ‰ä¼šç”Ÿæ•ˆã€‚
*/

.formula-wrapper {
  display: flex;
  flex-direction: row;
  align-items: center; /* å‚ç›´å±…ä¸­å¯¹é½ */
  width: 100%;
  max-width: 100%;
  margin: 1.5em 0;
  box-sizing: border-box;
  gap: 8px; /* å…¬å¼çš„å³ä¾§é—´è· */
}

.formula {
  flex: 1 1 auto;     /* å æ®å‰©ä½™ç©ºé—´ */
  
  /* ğŸ‘‡ğŸ‘‡ğŸ‘‡ æœ€å…³é”®çš„ä¸‰è¡Œä»£ç  ğŸ‘‡ğŸ‘‡ğŸ‘‡ */
  width: 0;           /* å¼ºåˆ¶é‡ç½®åŸºç¡€å®½åº¦ */
  min-width: 0;       /* ç§»é™¤æœ€å°å®½åº¦é™åˆ¶ */
  overflow-x: auto;   /* æº¢å‡ºæ—¶æ˜¾ç¤ºæ»šåŠ¨æ¡ */
  /* ğŸ‘†ğŸ‘†ğŸ‘† æœ€å…³é”®çš„ä¸‰è¡Œä»£ç  ğŸ‘†ğŸ‘†ğŸ‘† */

  text-align: center; /* å†…å®¹å°‘æ—¶å±…ä¸­ */
  -webkit-overflow-scrolling: touch; /* iOS é¡ºæ»‘æ»šåŠ¨ */
  padding-bottom: 4px; /* é˜²æ­¢æ»šåŠ¨æ¡å¤ªè´´ */
}

.equation-num {
  flex: 0 0 auto;     /* ç¼–å·ç¦æ­¢å‹ç¼© */
  font-size: 0.9em;
  color: var(--muted);
  white-space: nowrap;
}

/* ================== MathJax æš´åŠ›æ ·å¼é‡ç½® ================== */
/* å¿…é¡»ä½¿ç”¨ !important è¦†ç›– MathJax JS ç”Ÿæˆçš„å†…è”æ ·å¼ */

mjx-container[display="true"] {
  display: inline-block !important; /* å…³é”®ï¼šæ”¹ä¸ºè¡Œå†…å—ï¼Œä¾¿äº text-align æ§åˆ¶ */
  margin: 0 !important;
  max-width: none !important; /* å…è®¸å†…éƒ¨æ— é™å®½ï¼Œè¿™æ ·æ‰èƒ½è§¦å‘å¤–å±‚çš„æ»šåŠ¨ */
  width: auto !important;
  vertical-align: middle;
}

mjx-math {
  outline: none;
}

/* ================== å½©è‰²å…¬å¼ ================== */
.color-formula {
  width: 100%;
  display: flex;
  flex-direction: column; /* é»˜è®¤å‚ç›´æ’åˆ—æ›´å®‰å…¨ */
}

.color-formula .formula-core {
  display: flex;
  width: 100%;
  align-items: center;
  gap: 0.5em;
}

/* é€‚é…å½©è‰²å…¬å¼å†…éƒ¨çš„æ»šåŠ¨ */
.color-formula .formula {
  /* ç»§æ‰¿ä¸Šé¢çš„ Hack */
  flex: 1;
  width: 0;
  min-width: 0;
  overflow-x: auto;
}

/* ================== ç§»åŠ¨ç«¯è¡¥ä¸ ================== */
@media (max-width: 600px) {
  /* ç¡®ä¿æ‰€æœ‰å¤§å—å…ƒç´ éƒ½ä¸ä¼šè¶…å‡º */
  .block, figure, img {
    max-width: 100%;
  }
  
  /* æ‰‹æœºç«¯ç¼–å·ç¨å¾®å°ä¸€ç‚¹ */
  .equation-num {
    font-size: 0.8em;
    padding-left: 2px;
  }
}